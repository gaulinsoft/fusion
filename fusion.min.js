/*! ------------------------------------------------------------------------
//                                   Fusion
//  ------------------------------------------------------------------------
//
//                       Copyright 2014 Nicholas Gaulin
//
//       Licensed under the Apache License, Version 2.0 (the "License");
//      you may not use this file except in compliance with the License.
//                   You may obtain a copy of the License at
//
//                 http://www.apache.org/licenses/LICENSE-2.0
//
//     Unless required by applicable law or agreed to in writing, software
//      distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//     See the License for the specific language governing permissions and
//                       limitations under the License.
*/
(function(F,ha){F||(F={});var s=Object,E=s.create,R=s.defineProperty,I=s.freeze,W=s.getPrototypeOf,m=s.keys,X=s.preventExtensions,Y=s.seal,Z=s.prototype.hasOwnProperty,M=Array,s=M.prototype,S=M.isArray,M=Error,$=parseInt,aa=String.prototype;if(!(E&&R&&I&&W&&X&&Y&&S&&s.forEach&&s.indexOf&&aa.trim))throw new M("JavaScript engine does not support ECMAScript 5.");var I="undefined"!=typeof window&&null!=window&&window.window===window?window:{},N={Aacute:"C1",aacute:"E1",Acirc:"C2",acirc:"E2",acute:"B4",
AElig:"C6",aelig:"E6",Agrave:"C0",agrave:"E0",amp:"26",AMP:"26",Aring:"C5",aring:"E5",Atilde:"C3",atilde:"E3",Auml:"C4",auml:"E4",brvbar:"A6",Ccedil:"C7",ccedil:"E7",cedil:"B8",cent:"A2",copy:"A9",COPY:"A9",curren:"A4",deg:"B0",divide:"F7",Eacute:"C9",eacute:"E9",Ecirc:"CA",ecirc:"EA",Egrave:"C8",egrave:"E8",ETH:"D0",eth:"F0",Euml:"CB",euml:"EB",frac12:"BD",frac14:"BC",frac34:"BE",gt:"3E",GT:"3E",Iacute:"CD",iacute:"ED",Icirc:"CE",icirc:"EE",iexcl:"A1",Igrave:"CC",igrave:"EC",iquest:"BF",Iuml:"CF",
iuml:"EF",laquo:"AB",lt:"3C",LT:"3C",macr:"AF",micro:"B5",middot:"B7",nbsp:"A0",not:"AC",Ntilde:"D1",ntilde:"F1",Oacute:"D3",oacute:"F3",Ocirc:"D4",ocirc:"F4",Ograve:"D2",ograve:"F2",ordf:"AA",ordm:"BA",Oslash:"D8",oslash:"F8",Otilde:"D5",otilde:"F5",Ouml:"D6",ouml:"F6",para:"B6",plusmn:"B1",pound:"A3",quot:"22",QUOT:"22",raquo:"BB",reg:"AE",REG:"AE",sect:"A7",shy:"AD",sup1:"B9",sup2:"B2",sup3:"B3",szlig:"DF",THORN:"DE",thorn:"FE",times:"D7",Uacute:"DA",uacute:"FA",Ucirc:"DB",ucirc:"FB",Ugrave:"D9",
ugrave:"F9",uml:"A8",Uuml:"DC",uuml:"FC",Yacute:"DD",yacute:"FD",yen:"A5",yuml:"FF"},ba=/[<>&'"]/g;m(N).forEach(function(b,d,h){N[b+";"]=N[b]});var r=function(b,d,h,l,m,p){R(b,d,{configurable:!!p,enumerable:!!m,value:h,writable:!!l})},m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";E(null);var m=m+m.toLowerCase(),J=function(b,d,h){if(!d||!b||d.length>b.length)return!1;if(!h||h>b.length)h=b.length;return d==b.substr(h-d.length)},ca=function(b){return"&#"+b.charCodeAt(0)+";"},O=function(b,d,h){for(h||(h=" ");b.length<
d;)b=h+b;return b},y=function(b,d,h){if(!d||!b||d.length>b.length)return!1;if(!h||0>h)h=0;return d==b.substr(h,d.length)},K=function(b){return"a"<=b&&"z">=b||"A"<=b&&"Z">=b||"0"<=b&&"9">=b},da=function(b){return"0"==b||"1"==b},x=function(b){return"a"<=b&&"f">=b||"A"<=b&&"F">=b||"0"<=b&&"9">=b},z=function(b){return"a"<=b&&"z">=b||"A"<=b&&"Z">=b},B=function(b){return"\r"==b||"\n"==b||"\u2028"==b||"\u2029"==b},u=function(b){return"0"<=b&&"9">=b},ea=function(b){return"0"<=b&&"7">=b},A=function(b){return" "==
b||"\r"==b||"\n"==b||"\t"==b||"\f"==b},T=function(b){return"\t"==b||"\v"==b||"\f"==b||" "==b||"\u00a0"==b||"\ufeff"==b},E=function(b,d){if(0<=b.indexOf(" "))for(var h=b.split(" "),l=0,m=h.length;l<m;l++)r(D,h[l],d);else r(D,b,d)},D=function(){};r(D,"dev",!0,void 0,!0);r(D,"version","1.0.0b",void 0,!0);var P=function(b,d){b&&(this.lexer=new G(b,d))},m=P.prototype={},fa=function(b,d,h){return b.clone()};m._token=null;m.chain=null;m.lexer=null;m.previous=null;r(m,"clone",function(){var b=new P;b.chain=
this.chain?this.chain.map(fa):null;b.lexer=this.lexer?this.lexer.clone():null;b.previous=this.previous?this.previous.clone():null;return b},!0);r(m,"equals",function(b){if(!this.lexer!=!b.lexer||this.lexer&&!this.lexer.equals(b.lexer))return!1;var d=b.chain,h=this.chain;if((h&&h.length||0)!=(d&&d.length||0)||!this.previous!=!b.previous||this.previous&&!this.previous.equals(b.previous))return!1;if(h){b=0;for(var l=h.length;b<l;b++)if(!h[b].equals(d[b]))return!1}return!0},!0);r(m,"next",function(){if(!this.lexer)return null;
var b=this.lexer,d=this._token||b.next(),h=this.chain,l=this.previous;if(!d)return null;this.previous=b.token;var m=d.type;this._token||"HTMLDOCTYPEOpen"!=m?this._token&&(this._token=null):(this._token=d.clone(),d=d.clone(),this._token.start++,this._token.type="HTMLDOCTYPEDeclaration",d.end=d.start+1);if(!y(m,"CSS"))return d;h||(h=this.chain=[]);l&&(y(l.type,"CSS")||"FusionObjectSubstitutionClose"==l.type||"FusionSelectorSubstitutionClose"==l.type||"FusionStyleSubstitutionClose"==l.type)||h.unshift("*");
if(H(m)||L(m))return d;var p=h[0],a=null,e="CSSPunctuator"==m?d.text():null;if("{"==e)"*"!=p&&"@"!=p?h.unshift("*{"):h[0]+=e;else if("}"==e)"*{"==p||"*{:"==p?1<h.length?h.shift():h[0]="*":"@{"!=p&&"@{:"!=p||h.shift();else if("CSSSemicolon"==m)if("@"==p)h.shift();else{if("*{:"==p||"@{:"==p)h[0]=p[0]+"{"}else if("CSSColon"!=m||"*{"!=p&&"@{"!=p){if("CSSAtKeyword"!=m||"*"!=p&&"*{"!=p&&"@{"!=p||(p="@",h.unshift(p)),h="@{"==p&&"CSSIdentifier"==m?b.peek(d.end):null,a="*{"==p&&"CSSIdentifier"==m||h&&"CSSColon"==
h.type?"CSSDeclarationName":"*{:"==p||"@{:"==p?"CSSDeclarationValue":"*"==p||"@{"==p?"CSSSelector":"@"==p?"CSSAtRule":null,"*{:"==p||"@{:"==p)"CSSDelimiter"==m&&"!"==d.text()?(h=b.peek(d.end))&&"CSSIdentifier"==h.type&&"important"==h.text().toLowerCase()&&(h=b.peek(h.end))&&("CSSSemicolon"==h.type||"CSSPunctuator"==h.type&&"}"==h.text())&&(a="CSSDeclarationImportant"):l&&"CSSDelimiter"==l.type&&"!"==l.text()&&"CSSIdentifier"==m&&"important"==d.text().toLowerCase()&&(h=b.peek(d.end))&&("CSSSemicolon"==
h.type||"CSSPunctuator"==h.type&&"}"==h.text())&&(a="CSSDeclarationImportant")}else h[0]+=":";if(!a)return d;d=d.clone();d.type=a;return d},!0);r(m,"reset",function(){this.previous=this.chain=null;this.lexer&&this.lexer.reset()},!0);var G=function(b,d){b&&(this.source=b);d&&(this.language=d,this.chain="fhtml"==d?[new v]:"fjs"==d||"fcss"==d?[]:null)},m=G.prototype={},ga=function(b,d,h){return b.clone()},L=function(b){return"JavaScriptBlockComment"==b||"JavaScriptLineComment"==b||"HTMLCommentOpen"==
b||"HTMLCommentText"==b||"HTMLCommentClose"==b||"HTMLBogusCommentOpen"==b||"HTMLBogusCommentText"==b||"HTMLBogusCommentClose"==b||"CSSComment"==b},C=function(b,d){if("{"==d||"}"==d)b.braces+="{"==d?1:b.braces?-1:0;else if("("==d||")"==d)b.parentheses+="("==d?1:b.parentheses?-1:0;else if("["==d||"]"==d)b.brackets+="["==d?1:b.brackets?-1:0;else if("<"==d||">"==d)b.tags+="<"==d?1:b.tags?-1:0},U=function(b,d){if(!b)return!0;var h=b.type;return"JavaScriptPunctuator"==h?(h=b.text(),(")"!=h||d&&("for()"==
d||"if()"==d||"while()"==d||"with()"==d))&&("}"!=h||!d||"{}"!=d)&&"]"!=h&&"++"!=h&&"--"!=h):"JavaScriptReservedWord"==h?(h=b.text(),"case"==h||"delete"==h||"do"==h||"else"==h||"extends"==h||"in"==h||"instanceof"==h||"new"==h||"return"==h||"throw"==h||"typeof"==h||"void"==h||"yield"==h):"JavaScriptTemplateString"==h?"`"!=b.source.substr(b.end-1,1):"FusionAttributeTemplateStringHead"==h||"FusionAttributeTemplateStringMiddle"==h||"FusionSubstitutionOpen"==h||"FusionObjectSubstitutionOpen"==h||"FusionSelectorSubstitutionOpen"==
h||"FusionStyleSubstitutionOpen"==h},V=function(b){return"JavaScriptInvalidCharacter"==b||"HTMLText"==b||"HTMLEndTagText"==b},H=function(b){return"JavaScriptWhitespace"==b||"HTMLStartTagWhitespace"==b||"HTMLEndTagWhitespace"==b||"HTMLDOCTYPEWhitespace"==b||"CSSWhitespace"==b};m.chain=null;m.expression="";m.language="";m.position=0;m.source="";m.state="";m.token=null;r(m,"clone",function(){var b=new G;b.chain=this.chain?this.chain.map(ga):null;b.expression=this.expression;b.language=this.language;
b.position=this.position;b.source=this.source;b.state=this.state;b.token=this.token?this.token.clone():null;return b},!0);r(m,"equals",function(b){var d=b.chain,h=this.chain;if((h&&h.length||0)!=(d&&d.length||0))return!1;if(h)for(var l=0,m=h.length;l<m;l++)if(!h[l].equals(d[l]))return!1;return!this.token!=!b.token||this.token&&!this.token.equals(b.token)?!1:this.expression===b.expression&&this.language===b.language&&this.state===b.state},!0);r(m,"hack",function(){if(this.chain)return!1;var b=this.language;
this.chain="html"==b||"fhtml"==b?[new v]:"js"==b||"fjs"==b||"fcss"==b?[]:null;return!!this.chain},!0);r(m,"next",function(){var b=this.source,d=b.length,h=this.position,l=this.token,m=this.expression,p=this.language,a=this.position,e=this.state||p,k="fjs"==p||"fhtml"==p||"fcss"==p,q=this.chain,r=q?q.length:0,f=r?q[r-1]:null;if(0>a||a>=d)return null;var n="",g=!1,w=!1,t=null,s="";switch(e){case "js":case "fjs":case "JavaScriptIdentifier":case "JavaScriptReservedWord":case "JavaScriptPunctuator":case "JavaScriptNumber":case "JavaScriptDoubleQuotedString":case "JavaScriptSingleQuotedString":case "JavaScriptTemplateString":case "JavaScriptRegExp":case "JavaScriptBlockComment":case "JavaScriptLineComment":case "JavaScriptInvalidCharacter":case "JavaScriptWhitespace":case "FusionStartTagOpen":case "FusionEndTagOpen":case "FusionDirectiveTagOpen":case "FusionProperty":case "FusionAttributeTemplateStringHead":case "FusionAttributeTemplateStringMiddle":case "FusionSubstitutionOpen":case "FusionObjectSubstitutionOpen":case "FusionSelectorSubstitutionOpen":case "FusionStyleSubstitutionOpen":var c=
b[a];if(z(c)||"_"==c||"$"==c||"\\"==c||"@"==c&&k&&l&&("JavaScriptIdentifier"==l.type||!("JavaScriptPunctuator"!=l.type&&"CSSPunctuator"!=l.type||")"!=b[l.start]&&"]"!=b[l.start]))){"\\"!=c&&a++;e="@"==c?"FusionProperty":"JavaScriptIdentifier";do if(c=b[a],!K(c)&&"_"!=c&&"$"!=c&&"\u200c"!=c&&"\u200d"!=c){if("\\"!=c)break;g=b[a+1];if("u"!=g)break;g=b[a+2];if("{"==g){for(c=0;x(b[a+c+3]);)c++;if(c&&"}"==b[a+c+3])a+=c+3;else break}else if(x(g)&&x(b[a+3])&&x(b[a+4])&&x(b[a+5]))a+=5;else break}while(++a<
d);a==h?(a++,e="JavaScriptInvalidCharacter"):l&&"JavaScriptPunctuator"==l.type&&"."==l.text()||k&&"FusionProperty"==e||((d=b.substring(h,a),k&&l&&("FusionStartTagOpen"==l.type&&("break"==d||"case"==d||"continue"==d||"default"==d||"do"==d||"else"==d||"for"==d||"if"==d||"switch"==d||"while"==d)||"FusionEndTagOpen"==l.type&&"while"==d))?(e="JavaScriptReservedWord",t=new v("FusionEndTagOpen"==l.type?"</@"+d:"<@"+d)):"null"==d||"false"==d||"true"==d||"break"==d||"case"==d||"catch"==d||"class"==d||"const"==
d||"continue"==d||"debugger"==d||"default"==d||"delete"==d||"do"==d||"else"==d||"enum"==d||"export"==d||"extends"==d||"finally"==d||"for"==d||"function"==d||"if"==d||"implements"==d||"import"==d||"in"==d||"instanceof"==d||"interface"==d||"let"==d||"new"==d||"package"==d||"private"==d||"protected"==d||"public"==d||"return"==d||"static"==d||"super"==d||"switch"==d||"this"==d||"throw"==d||"try"==d||"typeof"==d||"var"==d||"void"==d||"while"==d||"with"==d||"yield"==d?((l=l&&"JavaScriptReservedWord"==l.type?
l.text():null)&&("get"==l||"set"==l)||f&&"{"==f.state||(e="JavaScriptReservedWord"),k&&"else"==l&&f&&"<@else"==f.state&&("do"==d||"for"==d||"if"==d||"switch"==d||"while"==d)&&(n=" "+d)):"get"!=d&&"set"!=d||!f||"{"!=f.state||(d=(g=this.peek(a))?g.type:null,"JavaScriptIdentifier"!=d&&"JavaScriptReservedWord"!=d)||(d=(g=this.peek(g.end))?g.type:null,"JavaScriptPunctuator"==d&&"("==b[g.start]&&(e="JavaScriptReservedWord",s="{:")))}else if(T(c)||B(c)){a++;e="JavaScriptWhitespace";do if(c=b[a],!T(c)&&!B(c))break;
while(++a<d)}else if('"'==c||"'"==c||"`"==c&&q||"}"==c&&f&&0==f.braces&&J(f.state,"`${"))for(g="}"==c&&"=`${"==f.state,l="}"!=c?c:"`",e=g?"FusionAttributeTemplateStringTail":'"'==l?"JavaScriptDoubleQuotedString":"'"==l?"JavaScriptSingleQuotedString":"JavaScriptTemplateString","}"==c&&(n=c+l,w=!0);++a<d;)if(c=b[a],"\\"==c){if(++a>=d)break;"\r"==b[a]&&"\n"==b[a+1]&&a++}else if(c==l){a++;break}else if("`"==l){if("$"==c&&"{"==b[a+1]){a+=2;t=new v(w?f.state:"`${");g&&(e="FusionAttributeTemplateStringMiddle");
break}}else{if(B(c))break}else if("/"==c)if(g=b[a+1],"*"==g)for(a++,e="JavaScriptBlockComment";++a<d;){if("*"==b[a]&&"/"==b[a+1]){a+=2;break}}else if("/"==g)for(a++,e="JavaScriptLineComment";++a<d&&!B(b[a]););else if(k&&">"==g&&f&&y(f.state,"<@")&&("<@break"==f.state||"<@case"==f.state||"<@continue"==f.state||"<@default"==f.state||"<@else"==f.state))a+=2,e="FusionStartTagSelfClose",n=c+g,w=!0;else if(U(l,m)){e="JavaScriptRegExp";for(g=!1;++a<d;)if(c=b[a],"\\"==c){if(++a>=d||B(b[a]))break}else if(!g&&
"/"==c){a++;break}else if(!g&&"["==c)g=!0;else if(g&&"]"==c)g=!1;else if(B(c))break;if("/"==c&&(c=b[a],z(c)||"_"==c||"$"==c)){a++;do if(c=b[a],!K(c)&&"_"!=c&&"$"!=c&&"\u200c"!=c&&"\u200d"!=c)break;while(++a<d)}}else a++,e="JavaScriptPunctuator","="==b[a]&&a++;else if(u(c)||"."==c&&u(b[a+1]))if(e="JavaScriptNumber",g="0"==c?b[a+1]:null,"0"!=c||"."==g||"e"==g||"E"==g){if("."!=c){for(a++;u(b[a]);)a++;c=b[a]}if("."==c){for(a++;u(b[a]);)a++;c=b[a]}g=b[a+1];if(("e"==c||"E"==c)&&(u(g)||("+"==g||"-"==g)&&
u(b[a+2])))for(a+="+"==g||"-"==g?3:2;u(b[a]);)a++}else{if(a++,(c="b"==g||"B"==g?da:"o"==g||"O"==g?ea:"x"==g||"X"==g?x:null)&&c(b[a+1]))for(a+=2;c(b[a]);)a++}else if("{"==c){if(a++,e="JavaScriptPunctuator",q){d=l&&"JavaScriptReservedWord"==l.type?l.text():null;g=l&&"JavaScriptPunctuator"==l.type?l.text():null;if(d&&"do"!=d&&"else"!=d&&"export"!=d&&"finally"!=d&&"import"!=d&&"try"!=d||g&&"{"!=g&&";"!=g&&"=>"!=g&&"}"!=g)if("("==g||"["==g||","==g||"?"==g||":"==g||"="==g)t=new v("{");else if(!m||!J(m,
"()"))if(d=(g=this.peek(a))?g.type:null,"JavaScriptIdentifier"==d||"JavaScriptReservedWord"==d||"JavaScriptDoubleQuotedString"==d||"JavaScriptSingleQuotedString"==d)l="JavaScriptIdentifier"==d?g.text():null,d=(g=this.peek(g.end))?g.type:null,"JavaScriptPunctuator"==d&&":"==g.text()?t=new v("{"):"get"!=l&&"set"!=l||"JavaScriptIdentifier"!=d&&"JavaScriptReservedWord"!=d||(d=(g=this.peek(g.end))?g.type:null,"JavaScriptPunctuator"==d&&"("==b[g.start]&&(t=new v("{")));f&&!t&&C(f,c)}}else if("}"==c){if(a++,
e="JavaScriptPunctuator",f){if(0==f.braces)if(k&&J(f.state,"${"))e="<${"==f.state?"FusionSubstitutionClose":"@{:${"==f.state?"FusionObjectSubstitutionClose":"@(${"==f.state||"@[${"==f.state?"FusionSelectorSubstitutionClose":"FusionStyleSubstitutionClose",n=c,w=!0;else if("{"==f.state||"{:"==f.state)s="{}",w=!0;w||C(f,c)}}else if("("==c){a++;e="JavaScriptPunctuator";if(k&&f&&(y(f.state,"<@")||y(f.state,"</@"))){if(d=f.state,"<@for"==d||"<@if"==d||"<@switch"==d||"<@while"==d||"<@else for"==d||"<@else if"==
d||"<@else switch"==d||"<@else while"==d||"</@while"==d)n=c}else q&&l&&"JavaScriptReservedWord"==l.type&&(l=l.text(),"catch"==l||"function"==l||"for"==l||"if"==l||"switch"==l||"while"==l||"with"==l)&&(t=new v(l+"("));f&&!t&&C(f,c)}else if(")"==c)a++,e="JavaScriptPunctuator",f&&J(f.state,"(")&&(k&&(y(f.state,"<@")||y(f.state,"</@"))?1==f.parentheses&&(n=c):0==f.parentheses&&(n=c,w=!0)),f&&!w&&C(f,c);else if("["==c||"]"==c)a++,e="JavaScriptPunctuator",f&&C(f,c);else if(":"==c)a++,e="JavaScriptPunctuator",
f&&0==f.braces&&"{"==f.state&&(s="{:");else if(","==c)a++,e="JavaScriptPunctuator",f&&0==f.braces&&"{:"==f.state&&(s="{");else if(";"==c||"?"==c||"~"==c)a++,e="JavaScriptPunctuator";else if("="==c)c=b[++a],e="JavaScriptPunctuator","="==c?"="==b[++a]&&a++:">"==c&&a++;else if("&"==c||"|"==c||"+"==c||"-"==c)g=b[a+1],a+=c==g||"="==g?2:1,e="JavaScriptPunctuator";else if("!"==c||"*"==c||"^"==c||"%"==c)e="JavaScriptPunctuator","="==b[a+1]?(a+=2,"!"==c&&"="==b[a]&&a++):a++;else if("<"==c||">"==c)if(g=b[a+
1],c==g||"="==g)a+=2,e="JavaScriptPunctuator",c==g&&(c=b[a],">"==g&&">"==c&&(c=b[++a]),"="==c&&a++);else if(a++,e="JavaScriptPunctuator",k)if(">"==c&&f&&(y(f.state,"<@")||y(f.state,"</@"))){if(J(f.state,"()")||"<@do"==f.state||"<@else do"==f.state)e=y(f.state,"</@")?"FusionEndTagClose":"FusionStartTagClose",n=c,w=!0}else"<"==c&&"/"==g&&"@"==b[a+1]&&f&&"<@"==f.state?(a+=2,e="FusionEndTagOpen"):">"==c&&l&&"FusionStartTagOpen"==l.type?e="FusionStartTagClose":">"==c&&l&&"FusionEndTagOpen"==l.type?e="FusionEndTagClose":
"<"==c&&z(g)&&U(l,m)&&(e="HTMLStartTagOpen",t=new v("<"),C(t,c));else"<"==c&&"/"==g&&"script"==b.substr(a+1,6)&&f&&"<script"==f.state&&(a++,e="HTMLEndTagOpen",n=">",w=!0);else"."==c?(c=b[++a],e="JavaScriptPunctuator","."==c&&"."==b[a+1]&&(a+=2)):k&&"@"==c?(g=b[a+1],a++,e="{"==g?"FusionObject":"("==g||"["==g?"FusionSelector":"JavaScriptInvalidCharacter",!q||"{"!=g&&"("!=g&&"["!=g||(t=new v(c+g))):(a++,e="JavaScriptInvalidCharacter");break;case "html":case "fhtml":case "HTMLStartTagClose":case "HTMLStartTagSelfClose":case "HTMLEndTagClose":case "HTMLCharacterReference":case "HTMLCommentClose":case "HTMLBogusCommentClose":case "HTMLDOCTYPEClose":case "HTMLCDATAClose":case "FusionStartTagClose":case "FusionStartTagSelfClose":case "FusionEndTagClose":case "FusionDirectiveTagClose":case "FusionSubstitutionClose":e=
"HTMLText";case "HTMLText":do if(c=b[a],"<"==c)if(g=b[a+1],z(g)){if(a!=h)break;a++;e="HTMLStartTagOpen";f&&C(f,c);break}else if("/"==g){if(a!=h)break;g=b[a+2];k&&"@"==g?(a+=3,e="FusionEndTagOpen"):z(g)?(a+=2,e="HTMLEndTagOpen"):(a+=2,e="HTMLBogusCommentOpen");break}else if(k&&"@"==g){if(a!=h)break;a+=2;e="FusionStartTagOpen";break}else if("!"==g){if(a!=h)break;g=b[a+2];">"==g?(a+=2,e="HTMLBogusCommentOpen"):k&&"@"==g?(a+=3,e="FusionDirectiveTagOpen"):"-"==g&&"-"==b[a+3]?(a+=4,e="HTMLCommentOpen"):
(g=b.substr(a+2,7),"DOCTYPE"==g?(a+=9,e="HTMLDOCTYPEOpen"):"[CDATA["==g?(a+=9,e="HTMLCDATAOpen"):(a+=2,e="HTMLBogusCommentOpen"));break}else{if("?"==g){if(a!=h)break;a+=2;e="HTMLBogusCommentOpen";break}}else if("&"==c){c=null;g=b[a+1];if("#"==g)if(g=b[a+2],"x"==g||"X"==g){if(g=b[a+3],x(g)){if(a!=h)break;a+=4;c=x}}else{if(u(g)){if(a!=h)break;a+=3;c=u}}else if(z(g)){if(a!=h)break;a+=2;c=K}if(c){for(e="HTMLCharacterReference";c(b[a]);)a++;";"!=b[a++]&&a--;break}}else if(k&&"$"==c&&"{"==b[a+1]&&f&&"<"==
f.state){if(a!=h)break;a+=2;e="FusionSubstitutionOpen";t=new v("<${");break}while(++a<d);break;case "HTMLStartTagOpen":case "HTMLEndTagOpen":if(z(b[a])){for(e="HTMLStartTagOpen"!=e?"HTMLEndTagName":"HTMLStartTagName";++a<d&&(c=b[a],">"!=c&&"/"!=c&&!A(c)););f&&(f.tag=b.substring(h,a));break}case "HTMLEndTagName":case "HTMLEndTagText":case "HTMLEndTagWhitespace":g="HTMLStartTagOpen"!=e;case "HTMLStartTagName":case "HTMLStartTagSolidus":case "HTMLStartTagWhitespace":case "HTMLAttributeName":case "HTMLAttributeOperator":case "HTMLAttributeValue":case "HTMLAttributeDoubleQuotedValue":case "HTMLAttributeSingleQuotedValue":case "FusionAttributeTemplateString":case "FusionAttributeTemplateStringTail":c=
b[a];if(">"==c)a++,e=g?"HTMLEndTagClose":"HTMLStartTagClose",f&&((d=g)||(d=f.tag,d="area"==d||"base"==d||"br"==d||"col"==d||"embed"==d||"hr"==d||"img"==d||"input"==d||"keygen"==d||"link"==d||"menuitem"==d||"meta"==d||"param"==d||"source"==d||"track"==d||"wbr"==d),d&&C(f,c),g||(k||"script"!=f.tag)&&"style"!=f.tag||(t=new v("<"+f.tag)),f.tag="");else if(A(c))for(a++,e=g?"HTMLEndTagWhitespace":"HTMLStartTagWhitespace";A(b[a]);)a++;else if(g)for(e="HTMLEndTagText";++a<d&&(c=b[a],">"!=c&&!A(c)););else if("="==
c&&l&&"HTMLAttributeName"==l.type)a++,e="HTMLAttributeOperator";else if(l&&"HTMLAttributeOperator"==l.type)for(l='"'==c||"'"==c||"`"==c&&k&&f&&"<"==f.state?c:null,e="`"==l?"FusionAttributeTemplateString":'"'==l?"HTMLAttributeDoubleQuotedValue":"'"==l?"HTMLAttributeSingleQuotedValue":"HTMLAttributeValue";++a<d;)if(c=b[a],l)if(c==l){a++;break}else{if("`"==l&&"$"==c&&"{"==b[a+1]){a+=2;e="FusionAttributeTemplateStringHead";t=new v("=`${");break}}else{if(">"==c||A(c))break}else if("/"==c)if(c=b[++a],e=
"HTMLStartTagSolidus",">"==c)a++,e="HTMLStartTagSelfClose",f&&(C(f,c),f.tag="");else for(;"/"==c;)c=b[++a];else for(e="HTMLAttributeName";++a<d&&(c=b[a],">"!=c&&"/"!=c&&"="!=c&&!A(c)););break;case "HTMLCommentOpen":e="HTMLCommentText";case "HTMLCommentText":do if(c=b[a],">"==c){if(a==h&&l&&"HTMLCommentOpen"==l.type){a++;e="HTMLCommentClose";break}}else if("-"==c)if(g=b[a+1],">"==g){if(a==h&&l&&"HTMLCommentOpen"==l.type){a+=2;e="HTMLCommentClose";break}}else if("-"==g&&(g=b[a+2],">"==g||"!"==g&&">"==
b[a+3])){if(a!=h)break;a+="!"==g?4:3;e="HTMLCommentClose";break}while(++a<d);break;case "HTMLBogusCommentOpen":e="HTMLBogusCommentText";case "HTMLBogusCommentText":do if(">"==b[a]){if(a!=h)break;a++;e="HTMLBogusCommentClose";break}while(++a<d);break;case "HTMLDOCTYPEOpen":case "HTMLDOCTYPEString":case "HTMLDOCTYPEDoubleQuotedString":case "HTMLDOCTYPESingleQuotedString":case "HTMLDOCTYPEWhitespace":c=b[a];if(">"==c)a++,e="HTMLDOCTYPEClose";else if(A(c))for(a++,e="HTMLDOCTYPEWhitespace";A(b[a]);)a++;
else for(l='"'==c||"'"==c?c:null,e='"'==c?"HTMLDOCTYPEDoubleQuotedString":"'"==c?"HTMLDOCTYPESingleQuotedString":"HTMLDOCTYPEString";++a<d;)if(c=b[a],l){if(c==l){a++;break}}else if(">"==c||A(c))break;break;case "HTMLCDATAOpen":e="HTMLCDATAText";case "HTMLCDATAText":do if("]"==b[a]&&"]"==b[a+1]&&">"==b[a+2]){if(a!=h)break;a+=3;e="HTMLCDATAClose";break}while(++a<d);break;case "css":case "fcss":case "CSSIdentifier":case "CSSNumber":case "CSSDelimiter":case "CSSPunctuator":case "CSSDimension":case "CSSPercentage":case "CSSComma":case "CSSColon":case "CSSSemicolon":case "CSSDoubleQuotedString":case "CSSSingleQuotedString":case "CSSHash":case "CSSFunction":case "CSSAtKeyword":case "CSSMatch":case "CSSUrl":case "CSSColumn":case "CSSUnicodeRange":case "CSSComment":case "CSSWhitespace":case "FusionObject":case "FusionSelector":case "FusionObjectSubstitutionClose":case "FusionSelectorSubstitutionClose":case "FusionStyleSubstitutionClose":c=
b[a];l=u(c);l||"+"!=c&&"-"!=c&&"."!=c||(g=b[a+1],l=u(g)||"."!=c&&"."==g&&u(b[a+2]));if(l){e="CSSNumber";if("."!=c){for(a++;u(b[a]);)a++;c=b[a]}if("."==c&&u(b[a+1])){for(a+=2;u(b[a]);)a++;c=b[a]}g=b[a+1];if(("e"==c||"E"==c)&&(u(g)||("+"==g||"-"==g)&&u(b[a+2]))){for(a+="+"==g||"-"==g?3:2;u(b[a]);)a++;c=b[a]}if("%"==c){a++;e="CSSPercentage";break}else if(!z(c)&&"_"!=c&&"\\"!=c&&"-"!=c&&"\u0080">c)break}if(l||z(c)||"_"==c||"\\"==c||"#"==c||"@"==c||"-"==c||"\u0080"<=c)if(l||"u"!=c&&"U"!=c||"+"!=b[a+1]||
!x(b[a+2])&&"?"!=b[a+2]){e=l?"CSSDimension":"#"==c?"CSSHash":"@"==c?"CSSAtKeyword":"CSSIdentifier";if("\\"==c){if(B(b[a+1])){l||a++;e=l?"CSSNumber":"CSSDelimiter";break}++a<d&&a++}else if("#"==c||"@"==c||"-"==c)if(g=b[a+1],z(g)||"_"==g||"-"==g||"\\"==g&&!B(b[a+2])||!("\u0080">g)||"#"==c&&u(g))if("@"==c&&"-"==g){g=b[a+2];if(!z(g)&&"_"!=g&&"-"!=g&&("\\"!=g||B(b[a+3]))&&"\u0080">g){a++;e="CSSDelimiter";break}a+=3}else a+=2;else{l||a++;e=l?"CSSNumber":"CSSDelimiter";break}else a++;do if(c=b[a],"\\"==
c){if(B(b[a+1]))break;if(++a>=d)break}else if(!K(c)&&"_"!=c&&"-"!=c&&"\u0080">c)break;while(++a<d);if("("==c&&"CSSIdentifier"==e&&(a++,e="CSSFunction",f&&C(f,c),a==h+4&&"url"==b.substr(h,3).toLowerCase())){for(c=0;A(b[a+c]);)c++;g=b[a+c];if('"'!=g&&"'"!=g){a+=c;e="CSSUrl";if(a>=d)break;do if(c=b[a],")"==c){a++;break}else if("\\"==c&&++a>=d)break;while(++a<d)}}}else{a+=2;e="CSSUnicodeRange";for(c=0;6>c&&x(b[a+c]);)c++;g=b[a+c];if("-"==g&&x(b[a+c+1]))for(a+=c+1,c=0;6>c&&x(b[a+c]);)c++;else if("?"==
g)for(;6>c&&"?"==b[a+c];)c++;a+=c}else if("/"==c&&"*"==b[a+1])for(a++,e="CSSComment";++a<d;){if("*"==b[a]&&"/"==b[a+1]){a+=2;break}}else if(A(c))for(a++,e="CSSWhitespace";A(b[a]);)a++;else if('"'==c||"'"==c)for(l=c,e='"'==l?"CSSDoubleQuotedString":"CSSSingleQuotedString";++a<d;)if(c=b[a],"\\"==c){if(++a>=d)break;"\r"==b[a]&&"\n"==b[a+1]&&a++}else if(c==l){a++;break}else{if(B(c))break}else if("$"==c||"*"==c||"^"==c||"|"==c||"~"==c)g=b[a+1],k&&"$"==c&&"{"==g&&f&&("@{:"==f.state||"@("==f.state||"@["==
f.state||"<style"==f.state)?(a+=2,e="@{:"==f.state?"FusionObjectSubstitutionOpen":"@("==f.state||"@["==f.state?"FusionSelectorSubstitutionOpen":"FusionStyleSubstitutionOpen",t=new v(f.state+c+g)):"|"==c&&"|"==g?(a+=2,e="CSSColumn"):"="==g?(a+=2,e="CSSMatch"):(a++,e="CSSDelimiter");else if("("==c||")"==c||"["==c||"]"==c||"{"==c||"}"==c)a++,e="CSSPunctuator",f&&C(f,c);else if(","==c)a++,e="CSSComma";else if(":"==c)a++,e="CSSColon",f&&"@{"==f.state&&(n=c);else if(";"==c)a++,e="CSSSemicolon",f&&"@{:"==
f.state&&(s="@{");else if("<"==c)if(c=b[++a],e="CSSDelimiter","!"==c&&"-"==b[a+1]&&"-"==b[a+2]&&f&&"<style"==f.state)for(a+=2,e="CSSComment";++a<d;){if("-"==b[a]&&"-"==b[a+1]&&">"==b[a+2]){a+=3;break}}else"/"==c&&"style"==b.substr(a+1,5)&&f&&"<style"==f.state&&(a++,e="HTMLEndTagOpen",n=">",w=!0);else a++,e="CSSDelimiter";break;default:return null}this.position=a;this.state=e;k&&f&&"<"==f.state&&0==f.tags?(n=">",w=!0,this.state=p):k&&f&&(("@{"==f.state||"@{:"==f.state)&&0==f.braces||"@("==f.state&&
0==f.parentheses||"@["==f.state&&0==f.brackets)?(w=!0,s="@("==f.state?"@()":"@["==f.state?"@[]":"@{}",this.state=p):t&&"HTMLStartTagClose"==e&&("<script"==t.state?this.state="js":"<style"==t.state&&(this.state="css"));f&&(s&&(f.state=s),n&&(f.state+=n));q&&(t?w&&r?q[r-1]=t:q.push(t):w&&q.pop());if(a==h)return null;l=new Q(e,b,h,a);H(e)||L(e)||(this.expression=f&&w?f.state:"",this.token=l);return l},!0);r(m,"peek",function(b,d){var h=new G;h.language=this.language;h.position=b||this.position;h.source=
this.source;h.state=d||this.state;for(var l=h.next();l;){var m=l.type;if(!H(m)&&!L(m))break;l=h.next()}return l},!0);r(m,"reset",function(){this.chain=null;this.expression="";this.position=0;this.state="";this.token=null},!0);(function(){}.prototype={}).lexer=null;var v=function(b){this.state=b||""},m=v.prototype={};m.braces=0;m.brackets=0;m.parentheses=0;m.state="";m.tag="";m.tags=0;r(m,"clone",function(){var b=new v;b.braces=this.braces;b.brackets=this.brackets;b.parentheses=this.parentheses;b.state=
this.state;b.tag=this.tag;b.tags=this.tags;return b},!0);r(m,"equals",function(b){return this.braces===b.braces&&this.brackets===b.brackets&&this.parentheses===b.parentheses&&this.state===b.state&&this.tag===b.tag&&this.tags===b.tags},!0);var Q=function(b,d,h,l){this.type=b;this.source=d;this.start=h;this.end=l},m=Q.prototype={};m.end=0;m.source="";m.start=0;m.type="";r(m,"clone",function(){return new Q(this.type,this.source,this.start,this.end)},!0);r(m,"equals",function(b){return this.type===b.type&&
this.text()===b.text()},!0);r(m,"html",function(){var b=this.text().replace(ba,ca);return!this.type||H(this.type)||V(this.type)?b:'<span class="fusion_'+this.type+'">'+b+"</span>"},!0);r(m,"node",function(){if(!this.type||H(this.type)||V(this.type))return document.createTextNode(this.text());var b=document.createElement("span");this.type&&b.setAttribute("class","fusion_"+this.type);b.innerText=this.text();return b},!0);r(m,"text",function(){return this.source.substring(this.start,this.end)},!0);E("highlight",
function(b,d,h){b=new P(b,d||"fjs");d="";var l=null;for(!h&&b.lexer&&b.lexer.hack();l=b.next();)d+=l.html();return d});E("parse",function(b,d,h){});E("tokenize",function(b,d,h){b=new G(b,d||"fjs");d=null;var l=[];for(h||b.hack();d=b.next();)l.push({type:d.type,start:d.start,end:d.end});return l});E("transpile",function(b,d,h,l,m,p){b=new G(b,"fjs");for(var a="",e=null,k=null,q=[],r=function(a,b){return b.toUpperCase()};e=b.next();){if("FusionSelector"==e.type||"FusionSelectorSubstitutionClose"==e.type){for(var f=
"",n="FusionSelector"==e.type,g=!0;e=b.next();)if("FusionSelectorSubstitutionOpen"==e.type)k=b.peek(),k&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(f+='"+(',g=!1),k=b.token;else if("FusionSelectorSubstitutionClose"==e.type)k&&"FusionSelectorSubstitutionOpen"==k.type||(f+=')+"',g=!0),k=b.token;else{if(!y(e.type,"CSS"))break;L(e.type)||(f+=e.text().replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n\\\n"),k=b.token)}var s=/^\(\s*(head|html|body)\s*\)$/i.exec(f);s?(f=s[1].toLowerCase(),
a+="document."+("html"==f?"documentElement":f)):(a+=n?"["==f[0]?(l||"document.__query")+'("':(h||"document.__find")+'("':')+"',a+=f.substr(n?1:0,f.length-(n&&g?2:1)),g&&(a+='")'))}else if("FusionObject"==e.type||"FusionObjectSubstitutionClose"==e.type)for(f="FusionObject"!=e.type,!f||k&&"FusionObjectSubstitutionOpen"==k.type||(a+=')+"');e=b.next();)if("FusionObjectSubstitutionOpen"==e.type)k&&"CSSColon"==k.type&&(a+='"'),(k=b.peek())&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(a+='"+('),k=b.token;
else if("FusionObjectSubstitutionClose"==e.type)k&&"FusionObjectSubstitutionOpen"==k.type||(a+=')+"'),k=b.token;else{if(!y(e.type,"CSS"))break;if(!L(e.type)){if(n=H(e.type)?e:null)if(e=b.next(),!e){a+=n.text();break}if(f){if("CSSPunctuator"==e.type&&"}"==e.text()&&"fjs"==b.state){k&&"CSSSemicolon"==k.type||(a+='"');n&&(a+=n.text());a+=e.text();k=b.token;continue}else if("CSSSemicolon"==e.type){a+='"';f=!1;n&&(a+=n.text());k=b.token;continue}else n&&(a+=n.text().replace(/\n/g,"\\n\\\n"));"FusionObjectSubstitutionOpen"==
e.type?(k=b.peek())&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(a+='"+('):"FusionObjectSubstitutionClose"==e.type?k&&"FusionObjectSubstitutionOpen"==k.type||(a+=')+"'):a+=e.text().replace(/\\/g,"\\\\").replace(/"/g,'\\"')}else"CSSIdentifier"==e.type&&k&&("CSSPunctuator"==k.type&&"{"==k.text()||"CSSSemicolon"==k.type)?("CSSSemicolon"==k.type&&(a+=","),n&&(a+=n.text()),a+='"',a+=e.text().replace(/^-+/,"").replace(/-+([a-z])/ig,r),a+='"'):"CSSColon"==e.type?(n&&(a+=n.text()),a+=e.text()):"CSSSemicolon"==
e.type?n&&(a+=n.text()):k&&"CSSColon"==k.type?(n&&(a+=n.text()),f=!0,"fjs"!=b.state&&(a+='"'),"FusionObjectSubstitutionOpen"==e.type?(k=b.peek())&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(a+='"+('):"FusionObjectSubstitutionClose"==e.type?k&&"FusionObjectSubstitutionOpen"==k.type||(a+=')+"'):a+=e.text().replace(/\\/g,"\\\\").replace(/"/g,'\\"')):(n&&(a+=n.text()),a+=e.text());k=b.token}}if(!e)break;if("FusionProperty"==e.type)a+=".__"+e.text().substr(1);else if("FusionSubstitutionOpen"==e.type||
"FusionStyleSubstitutionOpen"==e.type)a+='"+(';else if("FusionSubstitutionClose"==e.type||"FusionStyleSubstitutionClose"==e.type)a+=')+"';else if("HTMLStartTagOpen"==e.type)q.length&&(a+=e.text());else if("HTMLStartTagName"==e.type)f=e.text(),q.push(f),f=f.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),a+=1<q.length?f:(d||"document.__create")+'("'+f+'")';else if(q.length)if("HTMLStartTagClose"==e.type)!k||"HTMLAttributeName"!=k.type&&"HTMLAttributeOperator"!=k.type?!k||"FusionAttributeTemplateString"!=
k.type&&"FusionAttributeTemplateStringTail"!=k.type||(a+=")"):a+='"")',f=q[q.length-1],"area"==f||"base"==f||"br"==f||"col"==f||"embed"==f||"hr"==f||"img"==f||"input"==f||"keygen"==f||"link"==f||"menuitem"==f||"meta"==f||"param"==f||"source"==f||"track"==f||"wbr"==f?(q.pop(),q.length&&(a+=e.text())):a+=1<q.length?e.text():"."+(p||"__html")+'("';else if("HTMLEndTagOpen"==e.type)a+=1<q.length?e.text():'")';else if("HTMLEndTagName"==e.type){f=e.text();if(f!=q[q.length-1])throw"unmatched <"+q[q.length-
1]+"> tag";1<q.length&&(a+=f.replace(/\\/g,"\\\\").replace(/"/g,'\\"'))}else if("HTMLStartTagSelfClose"==e.type||"HTMLEndTagClose"==e.type||"HTMLEndTagSelfClose"==e.type)"HTMLStartTagSelfClose"==e.type&&k&&"HTMLAttributeName"==k.type?a+='"")':"HTMLStartTagSelfClose"!=e.type||!k||"FusionAttributeTemplateString"!=k.type&&"FusionAttributeTemplateStringTail"!=k.type||(a+=")"),q.pop(),q.length&&(a+=e.text());else if(1==q.length&&"HTMLAttributeName"==e.type)k&&"HTMLAttributeName"==k.type?a+='"")':!k||"FusionAttributeTemplateString"!=
k.type&&"FusionAttributeTemplateStringTail"!=k.type||(a+=")"),a+="."+(m||"__attr")+'("',a+=e.text().replace(/\\/g,"\\\\").replace(/"/g,'\\"'),a+='",';else if(1==q.length&&("HTMLAttributeValue"==e.type||"HTMLAttributeDoubleQuotedValue"==e.type||"HTMLAttributeSingleQuotedValue"==e.type)){f=e.text();"HTMLAttributeValue"!=e.type&&(f=f.substr(1,f.length-2));a+='"';e=0;for(n=f.length;e<n;){g=f[e];if("&"==g)if(k=f[e+1],"#"==k)if(k=f[e+2],"x"==k||"X"==k){if(k=f[e+3],x(k)){e+=3;k="";do{g=f[e];if(!x(g))break;
k+=g}while(++e<n);for(";"!=f[e++]&&e--;4>k.length;)k="0"+k;a+="\\u";a+=k;continue}}else{if("0"<=k&&"9">=k){e+=2;k="";do{g=f[e];if("0">g||"9"<g)break;k+=g}while(++e<n);";"!=f[e++]&&e--;for(k=$(k,10).toString(16);4>k.length;)k="0"+k;a+="\\u";a+=k;continue}}else{if(z(k)){e++;k="&";do{g=f[e];if(!K(g))break;k+=g}while(++e<n);";"!=f[e++]?e--:k+=";";g=N[k.substr(1)];S(g)?g="\\u"+O(g[0],4,"0")+"\\u"+O(g[1],4,"0"):g&&(g="\\u"+O(g,4,"0"));a+=g?g:k;continue}}else if('"'==g){a+='\\"';e++;continue}else if("\n"==
g){a+="\\n\\\n";e++;continue}else if("\\"==g){a+="\\\\";e++;continue}a+=g;e++}a+='")'}else if(1==q.length&&"HTMLStartTagSolidus"==e.type)k&&"HTMLAttributeName"==k.type?a+='"")':!k||"FusionAttributeTemplateString"!=k.type&&"FusionAttributeTemplateStringTail"!=k.type||(a+=")");else if("FusionAttributeTemplateString"==e.type||"FusionAttributeTemplateStringHead"==e.type||"FusionAttributeTemplateStringMiddle"==e.type||"FusionAttributeTemplateStringTail"==e.type){f=e.text();e="`"==f[0];n="`"==f[f.length-
1];if(e)a+='"';else if(!k||"FusionAttributeTemplateStringHead"!=k.type&&"FusionAttributeTemplateStringMiddle"!=k.type||"`"==k.source[k.end-1])a+=')+"';a+=f.substr(1,n?f.length-2:f.length-3).replace(/"/g,'\\"').replace(/\n/g,"\\n\\\n");n?a+='"':(k=b.peek())&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(a+='"+(')}else if("HTMLText"==e.type||y(e.type,"CSS"))a+=e.text().replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n\\\n");else if("HTMLStartTagWhitespace"==e.type)a+=k&&"HTMLAttributeOperator"==
k.type?e.text():e.text().replace(/^[^\r\n]+/,"");else{if(1<q.length||"HTMLEndTagText"!=e.type&&"HTMLEndTagSolidus"!=e.type&&"HTMLAttributeOperator"!=e.type)a+=e.text()}else"JavaScriptTemplateString"==e.type?(f=e.text(),e="`"==f[0],n="`"==f[f.length-1],e&&k&&("JavaScriptIdentifier"==k.type||"JavaScriptPunctuator"==k.type&&(")"==k.text()||k.text())),e?a+='"':k&&"JavaScriptTemplateString"==k.type&&"`"!=k.source[k.end-1]||(a+=')+"'),a+=f.substr(1,n?f.length-2:f.length-3).replace(/"/g,'\\"').replace(/\n/g,
"\\n\\\n"),n?a+='"':(k=b.peek())&&"JavaScriptPunctuator"==k.type&&"}"==k.text()||(a+='"+(')):a+=e.text();k=b.token}if(q.length)throw"unmatched <"+q[q.length-1]+"> tag";return a});"function"==typeof define&&define.amd?define(function(){return D}):"undefined"!=typeof module&&null!=module&&module.exports?module.exports=D:function(b){var d=F.f_Shorthand,h=F.f_Writable;"string"!=typeof d&&(d=!0===d?"f":"");"boolean"!=typeof h&&(h="undefined"!=typeof F.intellisense);!b||Z.call(b,"fusion")&&!h||(d&&r(b,
d,D,h),r(b,"fusion",D,h))}(I.window===I?I:F)})(this);